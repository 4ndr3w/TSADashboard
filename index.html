<!DOCTYPE html>
<html>
<head>
	<title>Home</title>
	<meta charset='UTF-8'>
	<meta http-equiv='refresh' content='1800; url=index.php'>
	<link rel="stylesheet" href="style/tiles.css">
	<script src="js/object.js" type="text/javascript"></script>
	<script src="js/tile.js" type="text/javascript"></script>
	<script type="text/javascript">
	var colors = new Array('#CC0033', '#CC6600', '#990099', '#3366CC', '#009933');
	function mkTSATimer(name, day, hours, mins)
	{
		color = Math.ceil(Math.random()*4);
		time = new tile(name, colors[color]);
		time.Head.addText("1",name);
		time.Body.addText("time",'Loading...');
		var nowTime = new Date();
		var targetTime = new Date(nowTime.getFullYear(), nowTime.getMonth(), day, hours, mins, 0, 0).getTime();
		
		time.Body.addCallBack("time", function(){
			tDif = targetTime-(new Date().getTime());
			
			if ( tDif < 0 )
			{
				return "Past";
			}
				
			
			hours = Math.floor(tDif/1000/60/60);
			min = Math.floor((tDif/1000/60)-hours*60);
			sec = Math.floor((tDif/1000)-(min*60)-(hours*60*60));
			
			return hours+":"+min+":"+sec;
		},1000);

		time.init();
	}
	
	function musicBoxNowPlaying()
	{
		nowPlaying = new tile("Now Playing", stv.blue);
		nowPlaying.Head.addText("1","Now Playing");
		nowPlaying.Body.addText("np",'Loading...');
		
		var npObject = {};
		nowPlaying.Body.addCallBack("np", function(){
			$.getJSON("/api/nowplaying", function(data)
			{
				npObject = data;
			});
			if ( npObject.title == undefined )
				return "Nothing";
			return npObject.title+" - "+npObject.album+" - "+npObject.artist;
		},1000);
		nowPlaying.init();
	}
	
	function init(){
		mkTSATimer("Event #1", 25, 7, 60);
		mkTSATimer("Event #1", 25, 7, 60);
		mkTSATimer("Event #1", 25, 7, 60);
		mkTSATimer("Event #1", 25, 7, 60);
		mkTSATimer("Event #1", 25, 7, 60);
		mkTSATimer("Event #1", 25, 7, 60);
		mkTSATimer("Event #1", 25, 7, 60);
		mkTSATimer("Event #1", 25, 7, 60);
		
		musicBoxNowPlaying();
	}
	window.onload = init;
	</script>
	<style type="text/css">
	body
	{
		background-color: #505050;
	}
	</style>
</head>
<body>
	<div id='container'>
	</div>
</body>
</html>
